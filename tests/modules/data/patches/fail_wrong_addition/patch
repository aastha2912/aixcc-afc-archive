@@ -198,6 +198,7 @@
 * blob_size MUST be a trusted value
 */
int harness( uint8_t *blob, uint32_t blob_size)
{
+    printf("CRS_DEBUG Initial buffer content: %s\n", blob);
    int index = 0;
    uint32_t command, command_count = 0;
    uint32_t flags, packet_size = 0;
@@ -213,6 +214,7 @@
        return -1;
    }

+    memcpy(&command_count, blob, 4);
    printf("CRS_DEBUG Command count: %d\n", command_count);
    index += 4;

@@ -221,6 +223,7 @@
    for ( int i = 0; i < command_count; i++) {
        if ( blob_size - index < 4 ) {
            return -1;
        }

+        memcpy(&command, blob + index, 4);
        printf("CRS_DEBUG Processing command: %d\n", command);
        index += 4;

        switch ( command ) {
@@ -263,6 +266,7 @@
            }

            index += packet_size;
+            printf("CRS_DEBUG Command %d processed, index now at %d\n", command, index);
            break;

        default:

