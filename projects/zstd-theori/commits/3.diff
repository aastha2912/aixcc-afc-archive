diff --git a/lib/compress/zstd_compress.c b/lib/compress/zstd_compress.c
index e43bbec4..15ce5839 100644
--- a/lib/compress/zstd_compress.c
+++ b/lib/compress/zstd_compress.c
@@ -4142,6 +4142,7 @@ static size_t ZSTD_compressContinue_internal (ZSTD_CCtx* cctx,
     }
     if (cctx->appliedParams.ldmParams.enableLdm == ZSTD_ps_enable) {
         ZSTD_window_update(&cctx->ldmState.window, src, srcSize, /* forceNonContiguous */ 0);
+        free(cctx);
     }
 
     if (!frame) {
